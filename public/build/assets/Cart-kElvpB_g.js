import{d as $,a as F,o as f,c as T,w as h,r as B,m as z,u as i,j as _,f as G,b as u,e as r,t as x,s as K,p as y,F as W,Q as R,q as te,Z as se,v as ae,l as le,x as ne,y as oe}from"./app--1P3JmIr.js";import{c as D,g as re}from"./AuthenticatedHeaderLayout.vue_vue_type_script_setup_true_lang-C2X-ZVUt.js";import{x as ie,c as P,d as de,I as X,v as ue,p as me,f as ce,_ as L}from"./Button.vue_vue_type_script_setup_true_lang-DaeYY_Of.js";import{M as pe,P as he,a as Y,g as fe,d as H,c as A}from"./getImageSource-Dl6JMhYe.js";import{_ as C}from"./Input.vue_vue_type_script_setup_true_lang-CBLQkMvh.js";import{_ as E}from"./Label.vue_vue_type_script_setup_true_lang-DCpOpIJJ.js";/**
 * @license lucide-vue-next v0.465.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=D("ArrowLeftIcon",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-vue-next v0.465.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=D("ShoppingCartIcon",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-vue-next v0.465.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=D("TrashIcon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),be=$({__name:"NumberField",props:{defaultValue:{},modelValue:{},min:{},max:{},step:{},formatOptions:{},locale:{},disabled:{type:Boolean},required:{type:Boolean},name:{},id:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(a,{emit:e}){const t=a,s=e,l=F(()=>{const{class:c,...p}=t;return p}),o=ie(l,s);return(c,p)=>(f(),T(i(de),z(i(o),{class:i(P)("grid gap-1.5",t.class)}),{default:h(()=>[B(c.$slots,"default")]),_:3},16,["class"]))}}),ye=$({__name:"NumberFieldContent",props:{class:{}},setup(a){const e=a;return(t,s)=>(f(),_("div",{class:G(i(P)("relative [&>[data-slot=input]]:has-[[data-slot=increment]]:pr-5 [&>[data-slot=input]]:has-[[data-slot=decrement]]:pl-5",e.class))},[B(t.$slots,"default")],2))}}),_e=$({__name:"NumberFieldDecrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(a){const e=a,t=F(()=>{const{class:l,...o}=e;return o}),s=X(t);return(l,o)=>(f(),T(i(ue),z({"data-slot":"decrement"},i(s),{class:i(P)("absolute top-1/2 -translate-y-1/2 left-0 p-3 disabled:cursor-not-allowed disabled:opacity-20",e.class)}),{default:h(()=>[B(l.$slots,"default",{},()=>[u(i(pe),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),xe=$({__name:"NumberFieldInput",props:{class:{}},setup(a){const e=a;return(t,s)=>(f(),T(i(me),{"data-slot":"input",class:G(i(P)("flex h-10 w-full rounded-md border border-input bg-background py-2 text-sm text-center ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e.class))},null,8,["class"]))}}),we=$({__name:"NumberFieldIncrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(a){const e=a,t=F(()=>{const{class:l,...o}=e;return o}),s=X(t);return(l,o)=>(f(),T(i(ce),z({"data-slot":"increment"},i(s),{class:i(P)("absolute top-1/2 -translate-y-1/2 right-0 disabled:cursor-not-allowed disabled:opacity-20 p-3",e.class)}),{default:h(()=>[B(l.$slots,"default",{},()=>[u(i(he),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ie=["src","alt"],Ve={class:"flex-1"},Me={class:"flex justify-between"},Ae={class:"text-sm md:text-base font-medium"},$e={key:0,class:"hidden md:block line-through text-muted-foreground"},Ce={class:"hidden md:block font-medium"},Ee={class:"mt-1 text-sm text-gray-500 dark:text-gray-300"},Ne={class:"block md:hidden mt-1 text-sm"},Re={class:"flex justify-between gap-2 md:gap-4 items-center mt-2"},je=$({__name:"CartItem",props:{item:{}},setup(a){const e=Y(),t=a,s=l=>{delete e.cartItems[l]};return(l,o)=>(f(),_(W,null,[r("img",{src:i(fe)(t.item.img)||"/placeholder.jpg",alt:t.item.name||"Item Image",class:"h-24 w-24 rounded-md object-cover mr-4"},null,8,Ie),r("div",Ve,[r("div",Me,[r("h3",Ae,x(t.item.name||"Unknown Item"),1),r("div",null,[i(H)(t.item.discount||i(e).user.discount)===0?(f(),_("p",$e,x(i(A)(i(e).cartItems[t.item.id].quantity*t.item.retail_price)),1)):K("",!0),r("p",Ce,x(i(A)(i(e).cartItems[t.item.id].quantity*t.item.retail_price*i(H)(t.item.discount||i(e).user.discount))),1)])]),r("p",Ee,"Цена: "+x(i(A)(t.item.retail_price))+"/"+x(t.item.unit),1),r("p",Ne,[o[2]||(o[2]=y("Всего: ")),r("b",null,x(i(A)(i(e).cartItems[t.item.id].quantity*t.item.retail_price)),1)]),r("div",Re,[r("div",null,[u(be,{modelValue:i(e).cartItems[t.item.id].quantity,"onUpdate:modelValue":o[0]||(o[0]=c=>i(e).cartItems[t.item.id].quantity=c)},{default:h(()=>[u(ye,null,{default:h(()=>[u(_e),u(xe),u(we)]),_:1})]),_:1},8,["modelValue"])]),r("div",null,[u(L,{variant:"outline",size:"icon",class:"size-10",onClick:o[1]||(o[1]=c=>s(t.item.id))},{default:h(()=>[u(i(ve),{class:"h-4 w-4"})]),_:1})])])])],64))}});var Fe=Object.defineProperty,Pe=(a,e,t)=>e in a?Fe(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,j=(a,e,t)=>Pe(a,typeof e!="symbol"?e+"":e,t);const Z={"#":{pattern:/[0-9]/},"@":{pattern:/[a-zA-Z]/},"*":{pattern:/[a-zA-Z0-9]/}},J=(a,e,t)=>a.replaceAll(e,"").replace(t,".").replace("..",".").replace(/[^.\d]/g,""),Q=(a,e,t)=>{var s;return new Intl.NumberFormat(((s=t.number)==null?void 0:s.locale)??"en",{minimumFractionDigits:a,maximumFractionDigits:e,roundingMode:"trunc"})},Se=(a,e=!0,t)=>{var s,l,o,c;const p=((s=t.number)==null?void 0:s.unsigned)!==!0&&a.startsWith("-")?"-":"",n=((l=t.number)==null?void 0:l.fraction)??0;let d=Q(0,n,t);const w=d.formatToParts(1000.12),k=((o=w.find(m=>m.type==="group"))==null?void 0:o.value)??" ",N=((c=w.find(m=>m.type==="decimal"))==null?void 0:c.value)??".",V=J(a,k,N);if(Number.isNaN(parseFloat(V)))return p;const I=V.split(".");if(I[1]!=null&&I[1].length>=1){const m=I[1].length<=n?I[1].length:n;d=Q(m,n,t)}let v=d.format(parseFloat(V));return e?n>0&&V.endsWith(".")&&!V.slice(0,-1).includes(".")&&(v+=N):v=J(v,k,N),p+v};class qe{constructor(e={}){j(this,"opts",{}),j(this,"memo",new Map);const t={...e};if(t.tokens!=null){t.tokens=t.tokensReplace?{...t.tokens}:{...Z,...t.tokens};for(const s of Object.values(t.tokens))typeof s.pattern=="string"&&(s.pattern=new RegExp(s.pattern))}else t.tokens=Z;Array.isArray(t.mask)&&(t.mask.length>1?t.mask=[...t.mask].sort((s,l)=>s.length-l.length):t.mask=t.mask[0]??""),t.mask===""&&(t.mask=null),this.opts=t}masked(e){return this.process(e,this.findMask(e))}unmasked(e){return this.process(e,this.findMask(e),!1)}isEager(){return this.opts.eager===!0}isReversed(){return this.opts.reversed===!0}completed(e){const t=this.findMask(e);if(this.opts.mask==null||t==null)return!1;const s=this.process(e,t).length;return typeof this.opts.mask=="string"?s>=this.opts.mask.length:s>=t.length}findMask(e){const t=this.opts.mask;if(t==null)return null;if(typeof t=="string")return t;if(typeof t=="function")return t(e);const s=this.process(e,t.slice(-1).pop()??"",!1);return t.find(l=>this.process(e,l,!1).length>=s.length)??""}escapeMask(e){const t=[],s=[];return e.split("").forEach((l,o)=>{l==="!"&&e[o-1]!=="!"?s.push(o-s.length):t.push(l)}),{mask:t.join(""),escaped:s}}process(e,t,s=!0){if(this.opts.number!=null)return Se(e,s,this.opts);if(t==null)return e;const l=`v=${e},mr=${t},m=${s?1:0}`;if(this.memo.has(l))return this.memo.get(l);const{mask:o,escaped:c}=this.escapeMask(t),p=[],n=this.opts.tokens!=null?this.opts.tokens:{},d=this.isReversed()?-1:1,w=this.isReversed()?"unshift":"push",k=this.isReversed()?0:o.length-1,N=this.isReversed()?()=>m>-1&&g>-1:()=>m<o.length&&g<e.length,V=M=>!this.isReversed()&&M<=k||this.isReversed()&&M>=k;let I,v=-1,m=this.isReversed()?o.length-1:0,g=this.isReversed()?e.length-1:0,O=!1;for(;N();){const M=o.charAt(m),b=n[M],S=(b==null?void 0:b.transform)!=null?b.transform(e.charAt(g)):e.charAt(g);if(!c.includes(m)&&b!=null?(S.match(b.pattern)!=null?(p[w](S),b.repeated?(v===-1?v=m:m===k&&m!==v&&(m=v-d),k===v&&(m-=d)):b.multiple&&(O=!0,m-=d),m+=d):b.multiple?O&&(m+=d,g-=d,O=!1):S===I?I=void 0:b.optional&&(m+=d,g-=d),g+=d):(s&&!this.isEager()&&p[w](M),S===M&&!this.isEager()?g+=d:I=M,this.isEager()||(m+=d)),this.isEager())for(;V(m)&&(n[o.charAt(m)]==null||c.includes(m));){if(s){if(p[w](o.charAt(m)),e.charAt(g)===o.charAt(m)){m+=d,g+=d;continue}}else o.charAt(m)===e.charAt(g)&&(g+=d);m+=d}}return this.memo.set(l,p.join("")),this.memo.get(l)}}const ee=a=>JSON.parse(a.replaceAll("'",'"')),Te=(a,e={})=>{const t={...e};a.dataset.maska!=null&&a.dataset.maska!==""&&(t.mask=Be(a.dataset.maska)),a.dataset.maskaEager!=null&&(t.eager=q(a.dataset.maskaEager)),a.dataset.maskaReversed!=null&&(t.reversed=q(a.dataset.maskaReversed)),a.dataset.maskaTokensReplace!=null&&(t.tokensReplace=q(a.dataset.maskaTokensReplace)),a.dataset.maskaTokens!=null&&(t.tokens=Oe(a.dataset.maskaTokens));const s={};return a.dataset.maskaNumberLocale!=null&&(s.locale=a.dataset.maskaNumberLocale),a.dataset.maskaNumberFraction!=null&&(s.fraction=parseInt(a.dataset.maskaNumberFraction)),a.dataset.maskaNumberUnsigned!=null&&(s.unsigned=q(a.dataset.maskaNumberUnsigned)),(a.dataset.maskaNumber!=null||Object.values(s).length>0)&&(t.number=s),t},q=a=>a!==""?!!JSON.parse(a):!0,Be=a=>a.startsWith("[")&&a.endsWith("]")?ee(a):a,Oe=a=>{if(a.startsWith("{")&&a.endsWith("}"))return ee(a);const e={};return a.split("|").forEach(t=>{const s=t.split(":");e[s[0]]={pattern:new RegExp(s[1]),optional:s[2]==="optional",multiple:s[2]==="multiple",repeated:s[2]==="repeated"}}),e};class Ue{constructor(e,t={}){j(this,"items",new Map),j(this,"eventAbortController"),j(this,"onInput",s=>{if(s instanceof CustomEvent&&s.type==="input"&&!s.isTrusted&&!s.bubbles)return;const l=s.target,o=this.items.get(l),c="inputType"in s&&s.inputType.startsWith("delete"),p=o.isEager(),n=c&&p&&o.unmasked(l.value)===""?"":l.value;this.fixCursor(l,c,()=>this.setValue(l,n))}),this.options=t,this.eventAbortController=new AbortController,this.init(this.getInputs(e))}update(e={}){this.options={...e},this.init(Array.from(this.items.keys()))}updateValue(e){e.value!==""&&e.value!==this.processInput(e).masked&&this.setValue(e,e.value)}destroy(){this.eventAbortController.abort(),this.items.clear()}init(e){const t=this.getOptions(this.options);for(const s of e){if(!this.items.has(s)){const{signal:o}=this.eventAbortController;s.addEventListener("input",this.onInput,{capture:!0,signal:o})}const l=new qe(Te(s,t));this.items.set(s,l),queueMicrotask(()=>this.updateValue(s)),s.selectionStart===null&&l.isEager()&&console.warn("Maska: input of `%s` type is not supported",s.type)}}getInputs(e){return typeof e=="string"?Array.from(document.querySelectorAll(e)):"length"in e?Array.from(e):[e]}getOptions(e){const{onMaska:t,preProcess:s,postProcess:l,...o}=e;return o}fixCursor(e,t,s){const l=e.selectionStart,o=e.value;if(s(),l===null||l===o.length&&!t)return;const c=e.value,p=o.slice(0,l),n=c.slice(0,l),d=this.processInput(e,p).unmasked,w=this.processInput(e,n).unmasked;let k=l;p!==n&&(k+=t?c.length-o.length:d.length-w.length),e.setSelectionRange(k,k)}setValue(e,t){const s=this.processInput(e,t);e.value=s.masked,this.options.onMaska!=null&&(Array.isArray(this.options.onMaska)?this.options.onMaska.forEach(l=>l(s)):this.options.onMaska(s)),e.dispatchEvent(new CustomEvent("maska",{detail:s})),e.dispatchEvent(new CustomEvent("input",{detail:s.masked}))}processInput(e,t){const s=this.items.get(e);let l=t??e.value;this.options.preProcess!=null&&(l=this.options.preProcess(l));let o=s.masked(l);return this.options.postProcess!=null&&(o=this.options.postProcess(o)),{masked:o,unmasked:s.unmasked(l),completed:s.completed(l)}}}const U=new WeakMap,We=(a,e)=>{if(a.arg==null||a.instance==null)return;const t="setup"in a.instance.$.type;a.arg in a.instance?a.instance[a.arg]=e:t&&console.warn("Maska: please expose `%s` using defineExpose",a.arg)},Le=(a,e)=>{var t;const s=a instanceof HTMLInputElement?a:a.querySelector("input");if(s==null||(s==null?void 0:s.type)==="file")return;let l={};if(e.value!=null&&(l=typeof e.value=="string"?{mask:e.value}:{...e.value}),e.arg!=null){const o=c=>{const p=e.modifiers.unmasked?c.unmasked:e.modifiers.completed?c.completed:c.masked;We(e,p)};l.onMaska=l.onMaska==null?o:Array.isArray(l.onMaska)?[...l.onMaska,o]:[l.onMaska,o]}U.has(s)?(t=U.get(s))==null||t.update(l):U.set(s,new Ue(s,l))},ze={class:"container p-0 md:p-4 rounded-xl"},De={class:"p-4 md:p-8 md:mt-8 md:border rounded-2xl"},He={key:0,class:"text-3xl font-semibold mb-6"},Ze={key:1,class:"text-center py-8"},Je={key:2,class:"flex flex-col md:flex-row md:space-x-8"},Qe={class:"md:w-2/3"},Ge={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ke={class:"md:w-1/3 mt-8 md:mt-0"},Xe={class:"bg-slate-50 dark:bg-slate-900 rounded-lg p-4 md:p-6"},Ye={class:"flex justify-between mb-2"},et={class:""},tt={class:"flex justify-between mb-2"},st={class:""},at={class:"border-t border-gray-200 dark:border-gray-700 mt-4 pt-4 flex justify-between items-center"},lt={class:"text-xl font-semibold"},mt=$({__name:"Cart",setup(a){const e=Y();e.items=R().props.items,e.additional_items=R().props.additional_items,e.glasses=R().props.glasses,e.services=R().props.services,e.user=R().props.user,e.initiateCartItems();const t=F(()=>Object.keys(e.cartItems).map(Number)),s=p=>e.getItemInfo(p)??null,l=te({surname:e.user.name.split(" ")[0],name:e.user.name.split(" ")[1],patronymic:e.user.name.split(" ")[2]}),o=F(()=>({name:(l.value.surname||"")+" "+(l.value.name||"")+" "+(l.value.patronymic||""),phone:e.user.phone,address:e.user.address,email:e.user.email})),c=()=>{console.log("Proceeding to checkout...")};return(p,n)=>(f(),_(W,null,[u(i(se),{title:"Корзина"}),u(re),r("div",ze,[r("div",De,[t.value.length>0?(f(),_("h2",He,"Ваша корзина")):K("",!0),t.value.length===0?(f(),_("div",Ze,[u(i(ke),{class:"h-16 w-16 mx-auto mb-4"}),n[7]||(n[7]=r("p",{class:"text-lg"},"Ваша корзина пуста",-1)),u(i(ae),{href:"/app/calculator",class:"inline-block mt-4"},{default:h(()=>[u(L,{variant:"secondary"},{default:h(()=>[u(i(ge),{class:"mr-2"}),n[6]||(n[6]=y(" Перейти к калькулятору "))]),_:1})]),_:1})])):(f(),_("div",Je,[r("div",Qe,[r("ul",Ge,[(f(!0),_(W,null,le(t.value,d=>(f(),_("li",{key:d,class:"py-6 flex items-center"},[u(je,{item:s(d)},null,8,["item"])]))),128))])]),r("div",Ke,[r("div",Xe,[n[11]||(n[11]=r("h3",{class:"text-lg font-semibold mb-4"},"Сводка по заказу",-1)),r("div",Ye,[n[8]||(n[8]=r("p",{class:""},"Всего",-1)),r("p",et,x(i(A)(i(e).total_price.without_discount)),1)]),r("div",tt,[n[9]||(n[9]=r("p",{class:""},"Скидка",-1)),r("p",st,x(i(A)(i(e).total_price.with_discount-i(e).total_price.without_discount)),1)]),r("div",at,[n[10]||(n[10]=r("p",{class:"text-lg font-semibold"},"Итого",-1)),r("p",lt,x(i(A)(i(e).total_price.with_discount)),1)])]),r("form",{onSubmit:ne(c,["prevent"]),class:"bg-slate-50 dark:bg-slate-900 rounded-lg p-4 md:p-6 mt-4 md:mt-6 flex flex-col gap-4"},[n[20]||(n[20]=r("h3",{class:"text-lg font-semibold"},"Информация о клиенте",-1)),r("div",null,[u(E,{class:"inline-block mb-2"},{default:h(()=>n[12]||(n[12]=[y("Фамилия "),r("span",{class:"text-destructive dark:text-red-500"},"*",-1)])),_:1}),u(C,{type:"text",modelValue:l.value.surname,"onUpdate:modelValue":n[0]||(n[0]=d=>l.value.surname=d),placeholder:"Иванов",required:""},null,8,["modelValue"])]),r("div",null,[u(E,{class:"inline-block mb-2"},{default:h(()=>n[13]||(n[13]=[y("Имя "),r("span",{class:"text-destructive dark:text-red-500"},"*",-1)])),_:1}),u(C,{type:"text",modelValue:l.value.name,"onUpdate:modelValue":n[1]||(n[1]=d=>l.value.name=d),placeholder:"Иван",required:""},null,8,["modelValue"])]),r("div",null,[u(E,{class:"inline-block mb-2"},{default:h(()=>n[14]||(n[14]=[y("Отчество")])),_:1}),u(C,{type:"text",modelValue:l.value.patronymic,"onUpdate:modelValue":n[2]||(n[2]=d=>l.value.patronymic=d),placeholder:"Иванович"},null,8,["modelValue"])]),r("div",null,[u(E,{class:"inline-block mb-2"},{default:h(()=>n[15]||(n[15]=[y("Адрес "),r("span",{class:"text-destructive dark:text-red-500"},"*",-1)])),_:1}),u(C,{type:"text",modelValue:o.value.address,"onUpdate:modelValue":n[3]||(n[3]=d=>o.value.address=d),placeholder:"г. Москва, ул. Пушкинская, д. 1",required:""},null,8,["modelValue"])]),r("div",null,[u(E,{class:"inline-block mb-2"},{default:h(()=>n[16]||(n[16]=[y("Email "),r("span",{class:"text-destructive dark:text-red-500"},"*",-1)])),_:1}),u(C,{type:"email",modelValue:o.value.email,"onUpdate:modelValue":n[4]||(n[4]=d=>o.value.email=d),placeholder:"email@mail.ru",required:""},null,8,["modelValue"])]),r("div",null,[u(E,{class:"inline-block mb-2"},{default:h(()=>n[17]||(n[17]=[y("Телефон "),r("span",{class:"text-destructive dark:text-red-500"},"*",-1)])),_:1}),oe(u(C,{type:"tel",modelValue:o.value.phone,"onUpdate:modelValue":n[5]||(n[5]=d=>o.value.phone=d),placeholder:"+7 (999) 999-99-99",required:""},null,8,["modelValue"]),[[i(Le),"+7 (###) ###-##-##"]])]),r("div",null,[u(L,{type:"submit"},{default:h(()=>n[18]||(n[18]=[y("Оформить заказ")])),_:1}),n[19]||(n[19]=r("p",{class:"text-xs block mt-4"},'Нажимая кнопку "Оформить заказ", вы даете согласие на обработку персональных данных.',-1))])],32)])]))])])],64))}});export{mt as default};
